---
title: "Домашняя работа №2"
author: "Екатерина Химич"
output: html_document

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

&nbsp;

#### **Задание 1.** Загрузите датасет insurance_cost.csv

```{r}
library(readr)
inc <- read_csv("C:/R/insurance_cost.csv")

head(inc)

#summary(inc)
#skim(inc)
```
&nbsp;

#### **Задание 2.** Сделайте интерактивный plotly график отношения индекса массы тела и трат на страховку. Раскрасьте его по колонке smoker

```{r}
library(plotly)
plot_ly(data = inc,
        x = ~ bmi,
        y = ~ charges)
```

&nbsp;

#### **Задание 3.** Сделайте тоже самое через ggplotly

```{r}
plot <- inc %>% 
  ggplot(aes(x = bmi, 
             y = charges)) + 
  geom_point(size = 1) +
  theme_minimal()

ggplotly(plot)
```

&nbsp;

#### **Задание 4.** Кратко сделайте корреляционный анализ данных insurance_cost. Посмотрите  документацию пакетов, которые мы проходили на занятии и, исходя из этого, постройте минимум два новых типа графика (которые мы не строили на занятии)

```{r}

```

&nbsp;

#### **Задание 5.** Превратите все номинативные переменные в бинарные/дамми. Т.е. sex и smoker должны стать бинарными (1/0), а каждое уникальное значение region – отдельной  колонкой, где 1 говорит о наличии этого признака для наблюдения, а 0 – обо тсутствии. Создайте новый датафрейм, где вы оставите только нумерические  переменные.

```{r}

```

&nbsp;

#### **Задание 6.** Постройте иерархическую кластеризацию на этом датафрейме

```{r}

```

&nbsp;

#### **Задание 7.** Используя документацию или предложенный  учебник сделайте ещё несколько возможных графиков по иерархической  кластеризации. Попробуйте раскрасить кластеры разными цветами

```{r}

```

&nbsp;

#### **Задание 8.** Сделайте одновременный график heatmap и иерархической кластеризации 

```{r}

```

&nbsp;

#### **Задание 9.** Проведите анализ данных полученных в задании 5 методом PCA. Кратко  проинтерпретируйте полученные результаты.

```{r}

```

&nbsp;

#### **Задание 10.** В финале вы получите график PCA по наблюдениям и переменным. Сделайте  кластеризацию7данных на нём по возрастным группам (создайте их сами на ваш  вкус, но их количество должно быть не меньше 3)

```{r}

```

&nbsp;

#### **Задание 11.** Подумайте и создайте ещё две номинативные  переменные, которые бы гипотетически могли хорошо разбить данные на  кластеры. Сделайте две соответствующие визуализации.

```{r}

```

&nbsp;

#### **Задание 12.** Давайте самостоятельно увидим, что снижение  размерности – это группа методов, славящаяся своей неустойчивостью.  Попробуйте самостоятельно поизменять дафрейм – удалить какие-либо  переменные или создать их (создавайте только дамми переменные). Ваша задача – резко поднять качество вашего анализа PCA (при этом, фактически, оперируя всё  теми же данными). Кратко опишите, почему добавление той или иной дамми переменной так улучшает PCA. 


```{r}

```

